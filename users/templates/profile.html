{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Account | HERBGLOW</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/profile.css' %}">
</head>
<body>

<!-- TOP BAR (same as index) -->
<div class="top-bar">
    <div class="marquee">
        <span>Free shipping all over India above ₹500</span>
        <span>⭐ 4.8 Stars across 20k reviews</span>
    </div>
</div>

{% include "navbar.html" %}

<section class="account-wrapper">

    <!-- SIDEBAR -->
    <aside class="account-sidebar">
        <ul>
            <li class="active">
                <i class="fa-solid fa-table-columns"></i>
                Dashboard
            </li>
            <li>
                <i class="fa-solid fa-box"></i>
                Order History
            </li>
            <!-- <li>
                <i class="fa-solid fa-location-dot"></i>
                Addresses
            </li> -->
            <li class="logout">
                <a href="{% url 'logout' %}">
                    <i class="fa-solid fa-right-from-bracket"></i>
                    Logout
                </a>
            </li>
        </ul>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="account-content">
        <h2>Account Details</h2> <button type="button" class="edit-btn" id="editProfileBtn">EDIT</button>
        <br>
        {% if messages %}
            {% for message in messages %}
                <p class="goto_success">{{message}}</p>
            {% endfor %}
        {% endif %}
        <!-- EDIT PROFILE FORM (HIDDEN INITIALLY) -->
<form action = "/profile-update/" method="post"  class="profile-form" id="profileForm" style="display: none;">
     {% csrf_token %}
    <div class="form-row">
        <label>Name</label>
        <input type="text" value="{{ profile.name }}" name="name">
    </div>
    <div class="form-row">
        <label>Username</label>
        <input type="text" value="{{ profile.username }}" disabled>
    </div>

    <div class="form-row">
        <label>Email</label>
        <input type="email" value="{{ profile.email }}" disabled>
    </div>

    <div class="form-row">
        <label>Mobile</label>
        <input type="text" value="{{ profile.mobile_number }}" name="mobile_number">
    </div>

    <div class="form-row">
        <label>Address</label>
        <textarea rows="3" name="address">{{ profile.address }}</textarea>
    </div>

    <button type="submit" class="save-btn">SAVE CHANGES</button>
</form>


        <div class="account-card" id="accountCard">
            <div class="row">
                <span>Name</span>
                <span>{{ profile.name|default:"—" }}</span>
            </div>
            <div class="row">
                <span>Username</span>
                <span>{{ profile.username|default:"—" }}</span>
            </div>

            <div class="row">
                <span>Email</span>
                <span>{{ profile.email }}</span>
            </div>

            <div class="row">
                <span>Mobile</span>
                <span>{{ profile.mobile_number|default:"—" }}</span>
            </div>

            <div class="row">
                <span>Address</span>
                <span>{{ profile.address|default:"—" }}</span>
            </div>
            
        </div>
    </main>

</section>
<script>
     const editBtn = document.getElementById("editProfileBtn");
    const profileForm = document.getElementById("profileForm");
    const accountCard = document.getElementById("accountCard");

    // initial state
    profileForm.style.display = "none";
    accountCard.style.display = "block";

    editBtn.addEventListener("click", () => {
        const isEditing = profileForm.style.display === "block";

        if (isEditing) {
            // CANCEL
            profileForm.style.display = "none";
            accountCard.style.display = "block";
            editBtn.textContent = "EDIT";
        } else {
            // EDIT
            profileForm.style.display = "block";
            accountCard.style.display = "none";
            editBtn.textContent = "CANCEL";
        }
    });
</script>
</body>
</html>
