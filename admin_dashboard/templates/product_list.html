{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product List</title>

  <link rel="stylesheet" href="{% static 'css/admin_style.css' %}">
  <link rel="stylesheet" href="{% static 'css/lists.css' %}">
</head>

<body>

  <div class="container">

    <!-- Sidebar -->
    <aside class="sidebar">
      <h2 class="logo">Herbglow</h2>

      <nav>
        <p class="menu-title">Main Menu</p>
        <a href="/admin/">Dashboard</a>
        <a href="#">Order Management</a>
        <a href="#">Customers</a>
        <a href="#">Coupon Code</a>
        <a href="#">Categories</a>
        <a href="#">Transaction</a>
        <a href="#">Brand</a>

        <p class="menu-title">Product</p>
        <a href="/admin/add-category">Category List</a>
        <a href="/admin/product-list"class="active">Product List</a>
        <a href="/admin/add-batch">Batch List</a>
        <a href="#">Product Reviews</a>

        <p class="menu-title">Admin</p>
        <a href="#">Admin Role</a>
        <a href="#">Control Authority</a>
        <a href="/admin/logout">Logout</a>
      </nav>
    </aside>

    <!-- Main Content -->
    <div class="main">

      <div class="table-card">

        <!-- Header -->
        <div class="table-header">
          {% if messages %}
          <div class="messages">
            {% for message in messages %}
            <p class="alert {{ message.tags }}">{{ message }}</p>
            {% endfor %}
          </div>
          {% endif %}
          <h3>Products</h3>
          <a href="/admin/add-product" class="btn btn-green">+ Add Product</a>
        </div>

        <!-- Product Table -->
        <div class="table-wrapper">
          <table class="admin-table">
            <thead>
              <tr>
                <th>Image</th>
                <th>Product</th>
                <th>Category</th>
                <th>Variants</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>

            <tbody>
              {% for product in products %}
              <tr>

                <!-- Primary Image -->
                <td>
                  {% for img in product.images %}
                  {% if img.is_primary %}
                  <img src="https://res.cloudinary.com/diipo18tm/{{ img.image }}" class="product-thumb" alt="">
                  {% endif %}
                  {% endfor %}
                </td>


                <!-- Product Info -->
                <td>
                  <strong>{{ product.product_name }}</strong><br>
                  <small>ID: {{ product.product_id }}</small>
                </td>

                <!-- Category -->
                <td>{{ product.category.category_name }}</td>

                <!-- Variant Count -->
                <td>
                  {{ product.variants|length }}
                </td>

                <!-- Status -->
                <td>
                  {% if product.is_active %}
                  <span class="status active">Active</span>
                  {% else %}
                  <span class="status inactive">Inactive</span>
                  {% endif %}
                </td>

                <!-- Actions -->
                <td class="actions">
                  <a href="/admin/edit-product/{{ product.product_id }}" class="btn-sm edit">Edit</a>
                  <a href="/admin/delete-product/{{ product.product_id }}" class="btn-sm delete"
                    onclick="return confirm('Are you sure you want to delete this product?');">
                    Delete
                  </a>
                </td>

              </tr>
              {% empty %}
              <tr>
                <td colspan="6" class="empty">No products found</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

      </div>

    </div>
  </div>

</body>

</html>